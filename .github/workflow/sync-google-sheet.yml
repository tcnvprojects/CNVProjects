name: Sync Google Sheet to JSON

on:
  workflow_dispatch:    # Allows manual trigger from GitHub UI
  schedule:
    - cron: '0 2 * * *'  # Runs daily at 2 AM UTC (adjust as needed)

jobs:
  sync:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repo
      uses: actions/checkout@v3

    - name: Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: 18

    - name: Install dependencies
      run: npm install googleapis@105 axios@1.5.0 js-yaml@4.1.0

    - name: Run sync script
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        GOOGLE_SERVICE_ACCOUNT: ${{ secrets.GOOGLE_SERVICE_ACCOUNT }}
        GOOGLE_SHEET_ID: '<YOUR_GOOGLE_SHEET_ID_HERE>'
        GITHUB_REPO: '${{ github.repository }}'
        GITHUB_ACTOR: '${{ github.actor }}'
      run: node sync-sheet.js
